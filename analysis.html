<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Here we provide a detailed analysis using more sophisticated statistics techniques.">

<title>Analysis – MA [46]15 Final Project TEAM 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ddd961a2510921635943dfbbd19534c4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MA [46]15 Final Project TEAM 3</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./big_picture.html"> 
<span class="menu-text">Identical Homes, Unequal Prices</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./analysis.html" aria-current="page"> 
<span class="menu-text">Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data.html"> 
<span class="menu-text">Data</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#dataset-1---analysis" id="toc-dataset-1---analysis" class="nav-link active" data-scroll-target="#dataset-1---analysis">Dataset 1 - Analysis</a>
  <ul class="collapse">
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#data-source" id="toc-data-source" class="nav-link" data-scroll-target="#data-source">Data Source</a></li>
  <li><a href="#urban-vs.-rural-housing-value" id="toc-urban-vs.-rural-housing-value" class="nav-link" data-scroll-target="#urban-vs.-rural-housing-value">Urban vs.&nbsp;Rural Housing Value</a></li>
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions">Research Questions</a></li>
  </ul></li>
  <li><a href="#how-does-homeownership-and-racial-demographics-interact-with-housing-prices" id="toc-how-does-homeownership-and-racial-demographics-interact-with-housing-prices" class="nav-link" data-scroll-target="#how-does-homeownership-and-racial-demographics-interact-with-housing-prices">How does homeownership and racial demographics interact with housing prices?</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#geographic-disparities-in-housing-value" id="toc-geographic-disparities-in-housing-value" class="nav-link" data-scroll-target="#geographic-disparities-in-housing-value">Geographic Disparities in Housing Value</a></li>
  <li><a href="#interaction-between-homeownership-race-and-housing-prices" id="toc-interaction-between-homeownership-race-and-housing-prices" class="nav-link" data-scroll-target="#interaction-between-homeownership-race-and-housing-prices">Interaction between Homeownership, Race, and Housing Prices</a></li>
  <li><a href="#affordability-burden-by-race" id="toc-affordability-burden-by-race" class="nav-link" data-scroll-target="#affordability-burden-by-race">Affordability Burden by Race</a></li>
  <li><a href="#modeling-and-inference" id="toc-modeling-and-inference" class="nav-link" data-scroll-target="#modeling-and-inference">Modeling and Inference</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model Diagnostics</a></li>
  <li><a href="#limitations-and-assumptions" id="toc-limitations-and-assumptions" class="nav-link" data-scroll-target="#limitations-and-assumptions">Limitations and Assumptions</a></li>
  <li><a href="#future-extensions" id="toc-future-extensions" class="nav-link" data-scroll-target="#future-extensions">Future Extensions</a></li>
  <li><a href="#overall-analysis" id="toc-overall-analysis" class="nav-link" data-scroll-target="#overall-analysis">Overall Analysis</a></li>
  </ul></li>
  <li><a href="#dataset-2---analysis" id="toc-dataset-2---analysis" class="nav-link" data-scroll-target="#dataset-2---analysis">Dataset 2 - Analysis</a>
  <ul class="collapse">
  <li><a href="#motivation-research-questions" id="toc-motivation-research-questions" class="nav-link" data-scroll-target="#motivation-research-questions">Motivation &amp; Research Questions</a></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</a></li>
  <li><a href="#statistical-modeling" id="toc-statistical-modeling" class="nav-link" data-scroll-target="#statistical-modeling">Statistical Modeling</a></li>
  <li><a href="#model-diagnostics-1" id="toc-model-diagnostics-1" class="nav-link" data-scroll-target="#model-diagnostics-1">Model Diagnostics</a></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1">Interpretation</a></li>
  <li><a href="#limitations-and-assumptions-1" id="toc-limitations-and-assumptions-1" class="nav-link" data-scroll-target="#limitations-and-assumptions-1">Limitations and Assumptions</a></li>
  <li><a href="#future-directions" id="toc-future-directions" class="nav-link" data-scroll-target="#future-directions">Future Directions</a></li>
  </ul></li>
  <li><a href="#cross-dataset-summary" id="toc-cross-dataset-summary" class="nav-link" data-scroll-target="#cross-dataset-summary">Cross-Dataset Summary</a>
  <ul class="collapse">
  <li><a href="#ipums-sociodemographic-disparities" id="toc-ipums-sociodemographic-disparities" class="nav-link" data-scroll-target="#ipums-sociodemographic-disparities">IPUMS: Sociodemographic Disparities</a></li>
  <li><a href="#kaggle-physical-property-characteristics" id="toc-kaggle-physical-property-characteristics" class="nav-link" data-scroll-target="#kaggle-physical-property-characteristics">Kaggle: Physical Property Characteristics</a></li>
  <li><a href="#two-sides-of-the-housing-market" id="toc-two-sides-of-the-housing-market" class="nav-link" data-scroll-target="#two-sides-of-the-housing-market">Two Sides of the Housing Market</a></li>
  <li><a href="#integrated-interpretation-and-future-direction" id="toc-integrated-interpretation-and-future-direction" class="nav-link" data-scroll-target="#integrated-interpretation-and-future-direction">Integrated Interpretation and Future Direction</a></li>
  <li><a href="#key-observations-from-each-dataset" id="toc-key-observations-from-each-dataset" class="nav-link" data-scroll-target="#key-observations-from-each-dataset">Key Observations from Each Dataset</a></li>
  <li><a href="#bridging-the-datasets" id="toc-bridging-the-datasets" class="nav-link" data-scroll-target="#bridging-the-datasets">Bridging the Datasets</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis</h1>
</div>

<div>
  <div class="description">
    Here we provide a detailed analysis using more sophisticated statistics techniques.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><img src="images/analysis_pic.jpg" class="img-fluid"></p>
<p>This comes from the file <code>analysis.qmd</code>.</p>
<section id="dataset-1---analysis" class="level2">
<h2 class="anchored" data-anchor-id="dataset-1---analysis">Dataset 1 - Analysis</h2>
<section id="motivation" class="level3">
<h3 class="anchored" data-anchor-id="motivation">Motivation</h3>
<p>The main purpose of the study is to examine the racial disparities in land ownership. The importance of distinguishing between urban and rural residential properties provides insight for analyzing ownership patterns, housing distribution, and land usage across different demographic groups. Historically, the American segregational economic policy has confined minority groups into urban areas, limiting their ability to acquire larger sets of land. By comparing the distribution between land and characteristics of homeownership, the result can help to identify the factors that are major contributors to generational wealth, therefore enhancing the understanding and influence of the racial wealth gap.</p>
</section>
<section id="data-source" class="level3">
<h3 class="anchored" data-anchor-id="data-source">Data Source</h3>
<p>This analysis is based on microdata from the IPUMS USA 2023 American Community Survey (ACS, 1-Year Sample), accessed via the IPUMS extract system. The dataset includes household-level demographic and housing characteristics, harmonized for research purposes.</p>
</section>
<section id="urban-vs.-rural-housing-value" class="level3">
<h3 class="anchored" data-anchor-id="urban-vs.-rural-housing-value">Urban vs.&nbsp;Rural Housing Value</h3>
<p>The boxplot below illustrates housing values across racial groups, separated by urban and rural locations. It reveals that Asian households living in urban areas tend to occupy the highest-value homes, whereas American Indian and Black homeowners have more limited value ranges, especially in rural settings. This reinforces how geography and race intersect to shape home equity.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="research-questions" class="level3">
<h3 class="anchored" data-anchor-id="research-questions">Research Questions</h3>
<ul>
<li>How does homeownership and racial demographics interact with housing prices?</li>
<li>Does the association between housing quality and rent price vary by racial differences in neighborhood?</li>
</ul>
</section>
</section>
<section id="how-does-homeownership-and-racial-demographics-interact-with-housing-prices" class="level2">
<h2 class="anchored" data-anchor-id="how-does-homeownership-and-racial-demographics-interact-with-housing-prices">How does homeownership and racial demographics interact with housing prices?</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Note: Each bar represents the <strong>distribution of house value tiers <em>within</em> each racial group</strong>, not across the full sample. This controls for unequal population sizes across races.</p>
</blockquote>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<p>The stacked bar chart displays, for each racial group, the percentage distribution of owned homes across three housing value tiers: Low (≤$100K), Medium ($100K–$300K), and High (&gt;$300K). Each bar adds up to 100%, emphasizing how the composition of housing wealth differs within each racial category of homeowners. This visualization highlights disparities in access to high-value housing across racial lines.</p>
</section>
<section id="geographic-disparities-in-housing-value" class="level3">
<h3 class="anchored" data-anchor-id="geographic-disparities-in-housing-value">Geographic Disparities in Housing Value</h3>
<p>The housing market varies not only by race and income but also by geography. To visualize spatial inequality, we present maps of average housing value and racial disparities across U.S. states.</p>
<section id="average-housing-value-by-state" class="level4">
<h4 class="anchored" data-anchor-id="average-housing-value-by-state">Average Housing Value by State</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This choropleth map shows the average housing value by state. We observe that housing values are generally higher in coastal regions—particularly in California and parts of the Northeast. In contrast, much of the Midwest and South exhibit lower average home values, reflecting broader geographic disparities in real estate markets.</p>
</section>
<section id="racial-gap-in-average-housing-value" class="level4">
<h4 class="anchored" data-anchor-id="racial-gap-in-average-housing-value">Racial Gap in Average Housing Value</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This map shows the average difference in housing values between White and Black homeowners across U.S. states. Positive values (shaded in yellow and orange) indicate that homes owned by White individuals are more valuable on average than those owned by Black individuals. States like Texas and Florida exhibit large positive gaps, while a few Northeastern states show small negative gaps. The variation highlights persistent racial disparities in housing wealth shaped by historical, geographic, and socioeconomic factors.</p>
<p>Comparing the two maps reveals that high average housing values do not necessarily correlate with large racial disparities. For example, California stands out with the highest average housing value, yet its racial value gap is also among the largest. In contrast, some Midwestern states have moderate home values but relatively small racial differences.</p>
</section>
</section>
<section id="interaction-between-homeownership-race-and-housing-prices" class="level3">
<h3 class="anchored" data-anchor-id="interaction-between-homeownership-race-and-housing-prices">Interaction between Homeownership, Race, and Housing Prices</h3>
<p>Homeownership does not reflect racial equity. Asian homeowners are concentrated in high-value homes while Black and American-Indian homeowners are clustered in the lower-value segments, reflecting the racial wealth gap.</p>
</section>
<section id="affordability-burden-by-race" class="level3">
<h3 class="anchored" data-anchor-id="affordability-burden-by-race">Affordability Burden by Race</h3>
<p>To further examine the relationship between home value and income, the boxplot below presents the affordability ratio—calculated as housing value divided by household income—by racial group. Notably, Asian homeowners exhibit the highest median affordability ratio (3.82), suggesting they carry the greatest relative cost burden despite owning more high-value homes. In contrast, White and American Indian households show lower median ratios, indicating relatively lower cost pressure even when housing prices vary across groups.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modeling-and-inference" class="level3">
<h3 class="anchored" data-anchor-id="modeling-and-inference">Modeling and Inference</h3>
<p>To examine how income, race, and location affect home values, we fit a <strong>multiple log-linear regression model</strong> using <code>VALUEH</code> (housing value) as the dependent variable. The key explanatory variables include logged income (<code>log(FTOTINC)</code>), race (<code>factor(RACE)</code>), and location type (factor(ACREHOUS), &gt;10 acres indicator).</p>
<section id="key-predictors" class="level4">
<h4 class="anchored" data-anchor-id="key-predictors">Key Predictors</h4>
<p>In addition to log household income, we include two categorical variables: race and house acreage. The race variable captures demographic differences across racial groups using dummy indicators. The <code>ACREHOUS</code> variable indicates whether the property has <strong>more than 10 acres of land</strong>, which may reflect rural-style housing or large-lot ownership, potentially influencing home value independently of income. #### Model and Predictor Selection Rationale</p>
<p>The decision to use a <strong>multiple log-log regression model</strong> stems from both the nature of the data and the economic interpretation desired. Housing values (<code>VALUEH</code>) and household income (<code>FTOTINC</code>) are both highly skewed, which can distort linear model assumptions. Taking the logarithm of these variables helps normalize the distributions, reduce heteroskedasticity, and allows the coefficients to be interpreted as <strong>elasticities</strong>—that is, percentage changes in housing value associated with percentage changes in income.</p>
<p>The <strong>predictor variables</strong> were chosen based on theoretical relevance and empirical patterns:</p>
<ul>
<li><strong>log(FTOTINC)</strong>: Income is a fundamental driver of housing demand. Logging this variable improves model fit and enables percentage-based interpretation.</li>
<li><strong>RACE (factor)</strong>: Racial disparities in housing access and value have been widely documented. Including race as a categorical predictor allows the model to measure differences in home value across demographic groups, even after adjusting for income.</li>
<li><strong>ACREHOUS (factor)</strong>: The acreage indicator (whether a home sits on more than 10 acres) captures a meaningful dimension of housing context, land use, and market segmentation.</li>
</ul>
<p>This combination of variables aims to balance <strong>parsimony</strong> with <strong>interpretability</strong>, providing insights into both economic and structural determinants of housing value while avoiding unnecessary model complexity or overfitting.</p>
</section>
<section id="model-specification" class="level4">
<h4 class="anchored" data-anchor-id="model-specification">Model Specification</h4>
<p>We estimate the following log-log model:</p>
<p><span class="math display">\[
\log(\text{VALUEH}_i) = \beta_0 + \beta_1 \log(\text{FTOTINC}_i) + \gamma \cdot \text{RACE}_i + \delta \cdot \text{ACREHOUS}_i + \varepsilon_i
\]</span></p>
<p>This specification captures the elasticity of income, racial differences, and the premium (or discount) associated with owning more than 10 acres of land.</p>
</section>
<section id="key-results" class="level4">
<h4 class="anchored" data-anchor-id="key-results">Key Results</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 7%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Estimate</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>log(FTOTINC)</td>
<td>0.438</td>
<td>A 1% increase in income is associated with a <strong>0.44%</strong> increase in housing value.</td>
</tr>
<tr class="even">
<td>Black/African American</td>
<td>-0.158</td>
<td>Homes owned by Black households are on average <strong>~15.8% less valuable</strong> than those of White households.</td>
</tr>
<tr class="odd">
<td>American Indian or Alaska Native</td>
<td>-0.423</td>
<td>Homes owned by American Indian/Alaska Native households are <strong>~34.4% less valuable</strong> than White households.</td>
</tr>
<tr class="even">
<td>Chinese</td>
<td>0.702</td>
<td>Chinese households own homes that are <strong>~101% more valuable</strong> than White households.</td>
</tr>
<tr class="odd">
<td>Japanese</td>
<td>0.732</td>
<td>Japanese households own homes <strong>~109% more valuable</strong> than White households.</td>
</tr>
<tr class="even">
<td>Other Asian or Pacific Islander</td>
<td>0.421</td>
<td>These households own homes <strong>~52.3% more valuable</strong> than White households.</td>
</tr>
<tr class="odd">
<td>Other race, nec</td>
<td>0.017</td>
<td>Slightly higher, but economically negligible difference vs.&nbsp;White households.</td>
</tr>
<tr class="even">
<td>Two major races</td>
<td>0.059</td>
<td>Homes owned by two-race households are <strong>~6.1% more valuable</strong> than those of White households.</td>
</tr>
<tr class="odd">
<td>Three or more major races</td>
<td>0.261</td>
<td>Households identifying with three or more races own homes <strong>~29.8% more valuable</strong>.</td>
</tr>
<tr class="even">
<td>Acreage &gt; 10 acres (vs ≤10 acres)</td>
<td>-0.031</td>
<td>Homes on large plots (&gt;10 acres) are about <strong>3.1% less valuable</strong>, holding other factors constant.</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Model fit</strong>: R² = 0.1673 (adj. R² = 0.1672). Although income, race, and land size significantly predict housing value, the modest R² indicates that important housing features and geographic context—such as neighborhood characteristics or housing quality—are likely needed to better explain variation in home values.</p>
<p>To interpret the coefficients as percent changes: <span class="math display">\[
\% \text{Change} = (e^{\beta} - 1) \times 100
\]</span></p>
</section>
<section id="interpretation" class="level4">
<h4 class="anchored" data-anchor-id="interpretation">Interpretation</h4>
<p>Income remains a strong predictor of housing value, but racial differences persist even after adjusting for financial status. For instance, Black and American Indian households own significantly lower-valued homes than Whites with the same income. Conversely, several Asian subgroups show significantly higher valuations.</p>
<p>This reinforces the idea that <strong>systemic disparities</strong> in housing markets are not merely economic, but also tied to <strong>demographic and geographic inequities</strong>.</p>
</section>
</section>
<section id="model-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics">Model Diagnostics</h3>
<section id="residuals-vs-fitted-hexbin" class="level4">
<h4 class="anchored" data-anchor-id="residuals-vs-fitted-hexbin">Residuals vs Fitted (Hexbin)</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The residual plot using hexbin visualization shows a dense cluster of observations centered near zero residuals, particularly concentrated around fitted values between 12 and 13. This pattern suggests that the model is reasonably well specified for the bulk of the data. Although no strong curvature is observed, there is some mild funneling—wider spread at lower fitted values—which may hint at mild heteroskedasticity. Nonetheless, the overall structure supports the assumptions of linearity and approximate constant variance for most observations.</p>
</section>
</section>
<section id="limitations-and-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="limitations-and-assumptions">Limitations and Assumptions</h3>
<p>While the multiple regression model includes income, race, and land acreage, it still has several <strong>limitations</strong>:</p>
<ul>
<li><strong>Omitted Variable Bias</strong>: Important housing characteristics (e.g., square footage, number of bedrooms, building age, neighborhood amenities, proximity to jobs/schools) are not included in the model. These omitted factors are likely correlated with both income and race, and may confound the estimated effects.</li>
<li><strong>Measurement Error</strong>: Both <code>VALUEH</code> and <code>FTOTINC</code> may be subject to reporting error or top-coding in survey data, especially in the upper tail, which could attenuate the estimated relationships.</li>
<li><strong>Simplified Geographic Controls</strong>: While the model could incorporate state fixed effects (<code>STATEICP</code>) to control for regional heterogeneity, our base specification only includes a coarse land classification (<code>ACREHOUS</code>) indicating whether a property exceeds 10 acres. This binary indicator does not fully capture urban–suburban–rural differences or local housing market dynamics.</li>
<li><strong>Linearity and Constant Variance Assumptions</strong>: Although diagnostics suggest reasonable model fit, some residual heteroskedasticity remains. This suggests that relationships may be nonlinear or vary across subgroups.</li>
</ul>
</section>
<section id="future-extensions" class="level3">
<h3 class="anchored" data-anchor-id="future-extensions">Future Extensions</h3>
<p>A more complete model would include richer housing attributes (e.g., lot size, building condition, year built), as well as finer geographic controls (e.g., ZIP code, county, census tract). Including <strong>state fixed effects</strong> via <code>factor(STATEICP)</code> would better control for unobserved regional differences. It would also be informative to explore <strong>interaction terms</strong>, such as <strong>income × race</strong>, to test whether income translates into home value equally across demographic groups. Finally, using <strong>panel data</strong> or exploiting quasi-experimental variation could help uncover <strong>causal</strong> rather than associative relationships.</p>
</section>
<section id="overall-analysis" class="level3">
<h3 class="anchored" data-anchor-id="overall-analysis">Overall Analysis</h3>
<p>This study reveals a clear racial divide in homeownership patterns across the U.S. While Asian homeowners are disproportionately represented in the high-value tier, Black and American Indian homeowners are more often found in the lower or medium tiers. These disparities persist geographically, with some states showing both high average home values and large racial gaps. Affordability burdens further highlight inequality, as groups with higher-valued homes also bear heavier income-to-value ratios.</p>
<p>Although the model shows that income, race, and land acreage significantly affect housing values, these variables explain only part of the variation. The regression results suggest that deeper structural differences—such as housing quality, local amenities, neighborhood segregation, or zoning policy—are likely at play. Future models incorporating additional housing attributes and interaction terms (e.g., income × race, income × region) will be essential for a more comprehensive understanding of equity in housing wealth.</p>
<hr>
</section>
</section>
<section id="dataset-2---analysis" class="level2">
<h2 class="anchored" data-anchor-id="dataset-2---analysis">Dataset 2 - Analysis</h2>
<section id="motivation-research-questions" class="level3">
<h3 class="anchored" data-anchor-id="motivation-research-questions">Motivation &amp; Research Questions</h3>
<p>Home prices have surged, yet buyers and policymakers still debate why some properties cost millions more than others. This study investigates three broad hypotheses: - <strong>Size‐driven pricing</strong> – Larger built‑up area should raise price, but by how much? - <strong>Amenity premiums</strong> – Features such as furnishing, bathrooms, parking, and extra stories may command additional value. - <strong>Independence of effects</strong> – Do those features each add value on their own, or are some simply proxies for one another (multicollinearity)?</p>
<p>Answering these helps buyers budget efficiently and lets developers prioritise high‑value upgrades.</p>
</section>
<section id="exploratory-data-analysis-eda" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</h3>
<p><strong>Area and Price</strong><br>
What we see: Price rises with area, but the cloud gets wider at larger sizes. That “fan‑shape” warns that area alone is far from sufficient; luxury fit‑outs and location are also at play.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Furnishing Status</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Furnished homes cluster at the top of the price spectrum, semi‑furnished sit in the middle, and unfurnished trail behind. The median gap between furnished and unfurnished units is roughly two million (local currency), hinting at a strong convenience premium.</p>
<p><strong>Bedrooms</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Median price increases steadily from one to five bedrooms, but dispersion within each group is large—evidence that bedroom count alone doesn’t guarantee luxury. For example, some three‑bedroom flats fetch more than four‑bedroom houses because of high‑end finishes.</p>
<p><strong>Parking</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Going from zero to one parking space lifts the median price by ≈ 15 %. A second space still adds value, but the incremental gain diminishes—suggesting diminishing marginal utility.</p>
<p><strong>Correlation Check</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Correlations among predictors stay below 0.60. That is low enough to keep variance‑inflation factors (VIF) below 2, so we can include all variables in one regression without worrying about unstable coefficients.</p>
</section>
<section id="statistical-modeling" class="level3">
<h3 class="anchored" data-anchor-id="statistical-modeling">Statistical Modeling</h3>
<section id="why-a-loglog-model" class="level4">
<h4 class="anchored" data-anchor-id="why-a-loglog-model">Why a log‑log model?</h4>
<ul>
<li><strong>Heteroskedasticity</strong>: Raw prices show larger spread at higher values. Logging price and area pulls variances into roughly constant range.</li>
<li><strong>Interpretability</strong>: Coefficients on logged variables read as elasticities—handy for business decisions.</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The log-log transformation reveals a near-linear trend, suggesting that a constant elasticity model is appropriate for capturing the relationship between area and price.</p>
</section>
</section>
<section id="model-diagnostics-1" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics-1">Model Diagnostics</h3>
<section id="residuals-vs-fitted-plot" class="level4">
<h4 class="anchored" data-anchor-id="residuals-vs-fitted-plot">Residuals vs Fitted Plot</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The residuals are roughly symmetrically distributed around zero, with no visible curvature or fan-shaped patterns. This supports the assumption of linearity and homoskedasticity. A small spread (within ±1) indicates a tight fit between predicted and observed log-prices.</p>
</section>
<section id="q-q-plot" class="level4">
<h4 class="anchored" data-anchor-id="q-q-plot">Q-Q Plot</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="analysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The Q-Q plot of residuals shows that most residuals lie along the 45-degree reference line, indicating approximate normality. Minor deviation at the tails is expected and does not severely violate model assumptions.</p>
<p>Overall, these diagnostics suggest that the multiple linear regression model is well-specified and suitable for inference.</p>
<p><strong>Model specification</strong><br>
<span class="math display">\[
\log(\text{price}) = \beta_0 + \beta_1 \log(\text{area}) + \beta_2 \cdot \text{bedrooms} + \beta_3 \cdot \text{bathrooms} + \beta_4 \cdot \text{stories} + \beta_5 \cdot \text{parking} + \beta_6 \cdot \text{semi-furnished} + \beta_7 \cdot \text{unfurnished} + \varepsilon
\]</span> Baseline furnishing category = “furnished”.<br>
Robust (Huber–White) standard errors are used to guard against possible heteroskedasticity. A Durbin–Watson statistic of 1.18 suggests mild residual autocorrelation, although the model is not time-series in nature.</p>
<p><strong>Key results (robust SEs)</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 6%">
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>β̂</th>
<th>% impact</th>
<th>95 % CI</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>log(area)</td>
<td>0.39</td>
<td>+0.39 % per +1 %</td>
<td>0.34–0.45</td>
<td>Size matters, but less than proportional.</td>
</tr>
<tr class="even">
<td>Bedrooms</td>
<td>0.04</td>
<td>+4 % per room</td>
<td>0.01–0.07</td>
<td>Small yet significant.</td>
</tr>
<tr class="odd">
<td>Bathrooms</td>
<td>0.18</td>
<td>+20 % per bath</td>
<td>0.14–0.23</td>
<td>Largest single‑room effect.</td>
</tr>
<tr class="even">
<td>Stories</td>
<td>0.10</td>
<td>+11 % per floor</td>
<td>0.08–0.13</td>
<td>Two‑storey vs.&nbsp;one‑storey ≈ 11 % uplift.</td>
</tr>
<tr class="odd">
<td>Parking</td>
<td>0.05</td>
<td>+5 % per spot</td>
<td>0.03–0.08</td>
<td>Still valuable after controls.</td>
</tr>
<tr class="even">
<td>Semi‑furnished</td>
<td>–0.02</td>
<td>–2 %</td>
<td>–0.07–0.03</td>
<td>Not distinguishable from furnished.</td>
</tr>
<tr class="odd">
<td>Unfurnished</td>
<td>–0.17</td>
<td>–15 %</td>
<td>–0.22– –0.11</td>
<td>Clear discount.</td>
</tr>
</tbody>
</table>
<p><strong>Model fit</strong>: R² = 0.60 (adj. R² = 0.60). VIF all &lt; 1.7, confirming low multicollinearity.</p>
</section>
</section>
<section id="interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-1">Interpretation</h3>
<ul>
<li><strong>Elastic size premium</strong>: Doubling floor area (+100 %) raises price by ~ 31 % (because 1.00×0.39 = 0.39; e^0.39 ≈ 1.48). Returns to scale are therefore diminishing.</li>
<li><strong>Quality of living spaces</strong>: One extra bathroom is worth roughly five bedrooms (20 % vs.&nbsp;4 %). Developers looking for affordable upgrades should prioritise bathroom count.</li>
<li><strong>Furnishing’s impact</strong>: Being unfurnished strips ~15 % off value, whereas “semi‑furnished” is statistically on par with “furnished.”</li>
<li><strong>Parking spots</strong>: Each additional space fetches about 5 % more, in line with urban planners’ estimates of parking scarcity premiums.</li>
</ul>
</section>
<section id="limitations-and-assumptions-1" class="level3">
<h3 class="anchored" data-anchor-id="limitations-and-assumptions-1">Limitations and Assumptions</h3>
<ul>
<li><strong>Missing Fine-Grained Geographic Controls</strong>: The dataset lacks latitude/longitude or neighborhood-level identifiers (e.g., ZIP codes), limiting the ability to control for <strong>local housing market effects</strong>. As a result, some estimated coefficients may inadvertently capture unobserved neighborhood quality.</li>
<li><strong>Cross-Sectional Data</strong>: The dataset represents a single point in time, ignoring temporal dynamics in housing markets. Without panel data, we cannot account for market cycles or unobserved household characteristics via fixed effects or repeat-sales models.</li>
<li><strong>Coarse Variable Definitions</strong>: Variables like <code>furnishingstatus</code> are coarse and categorical; they do not capture within-category heterogeneity (e.g., luxury vs.&nbsp;basic furniture), potentially understating their influence.</li>
<li><strong>Model Assumptions</strong>: The Durbin–Watson statistic &lt; 2 indicates <strong>potential residual autocorrelation</strong>, which violates the OLS assumption of independent errors. Although robust standard errors are used, more advanced techniques (e.g., clustering by region or mixed-effects models) may yield more reliable inference.</li>
</ul>
</section>
<section id="future-directions" class="level3">
<h3 class="anchored" data-anchor-id="future-directions">Future Directions</h3>
<p>To deepen the analysis of housing price determinants, future work could incorporate more granular <strong>location identifiers</strong> (e.g., ZIP code, district) to control for local market variation and neighborhood effects. Including <strong>additional structural attributes</strong> such as year built, renovation status, or energy efficiency could improve explanatory power and reduce omitted variable bias.</p>
<p>Moreover, interaction terms (e.g., <code>log(area) × furnishing status</code>, or <code>bedrooms × stories</code>) could help detect <strong>nonlinearities and conditional effects</strong>. To address potential residual correlation across homes within the same neighborhood, <strong>multilevel models</strong> or <strong>clustering by region</strong> would enhance statistical robustness.</p>
<p>Finally, if panel data becomes available, <strong>fixed-effects models</strong> could be used to control for unobserved household or location-specific traits, enabling stronger causal inference about housing value drivers over time.</p>
</section>
</section>
<section id="cross-dataset-summary" class="level2">
<h2 class="anchored" data-anchor-id="cross-dataset-summary">Cross-Dataset Summary</h2>
<p>This project used two complementary datasets to examine determinants of housing value in the United States.</p>
<section id="ipums-sociodemographic-disparities" class="level3">
<h3 class="anchored" data-anchor-id="ipums-sociodemographic-disparities">IPUMS: Sociodemographic Disparities</h3>
<p>The <strong>IPUMS housing dataset</strong> highlighted sociodemographic disparities in homeownership and property value. Even after controlling for income, racial differences in housing value remained substantial. Asian subgroups (particularly Chinese and Japanese) owned significantly higher-valued homes, while Black and American Indian households lagged behind, reflecting persistent structural inequalities.</p>
</section>
<section id="kaggle-physical-property-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="kaggle-physical-property-characteristics">Kaggle: Physical Property Characteristics</h3>
<p>The <strong>Kaggle housing dataset</strong>, on the other hand, emphasized property-specific features like square footage, number of bedrooms, bathrooms, and parking capacity. The correlation heatmap revealed that <strong>area</strong> and <strong>number of bathrooms</strong> are most strongly associated with price, suggesting that functional space and comfort play a key role in housing valuation.</p>
</section>
<section id="two-sides-of-the-housing-market" class="level3">
<h3 class="anchored" data-anchor-id="two-sides-of-the-housing-market">Two Sides of the Housing Market</h3>
<p>Together, these datasets reveal two sides of the housing market:</p>
<ol type="1">
<li>In <strong>IPUMS</strong>, social identity (race, income) plays a dominant role. It focuses on <strong>who</strong> owns valuable homes is shaped by race, income, and geography.<br>
</li>
<li>In <strong>Kaggle</strong>, material characteristics (space, amenities) dominate. It focuses on <strong>why</strong> homes are valued differently is largely explained by their structural features.</li>
</ol>
</section>
<section id="integrated-interpretation-and-future-direction" class="level3">
<h3 class="anchored" data-anchor-id="integrated-interpretation-and-future-direction">Integrated Interpretation and Future Direction</h3>
<p>This side-by-side analysis demonstrates that both <strong>who</strong> owns valuable homes and <strong>why</strong> those homes are valued are influenced by distinct yet intersecting factors. Future work could benefit from integrating sociodemographic and physical property data to develop more accurate predictive models and inform equity-driven housing policy.</p>
<p>Although the IPUMS and Kaggle datasets cannot be directly merged due to different structures and identifiers, we were able to conduct a comparative analysis by aligning them through a common outcome variable: <strong>housing value</strong>.</p>
</section>
<section id="key-observations-from-each-dataset" class="level3">
<h3 class="anchored" data-anchor-id="key-observations-from-each-dataset">Key Observations from Each Dataset</h3>
<p>In the IPUMS dataset, we found that race significantly influences housing value even after controlling for income—highlighting persistent disparities, with Black and American Indian households typically owning lower-valued homes, and Chinese and Japanese households owning higher-valued ones.</p>
<p>In the Kaggle dataset, housing value was most strongly predicted by <strong>physical characteristics</strong>, such as total area and number of bathrooms.</p>
</section>
<section id="bridging-the-datasets" class="level3">
<h3 class="anchored" data-anchor-id="bridging-the-datasets">Bridging the Datasets</h3>
<p>By observing that race affects housing value in one dataset and that housing value is closely tied to home size in the other, we establish an <strong>indirect bridge</strong>:<br>
<strong>racial disparities in housing value may, in part, reflect differences in the size and quality of homes owned across racial groups</strong>. This cross-dataset insight suggests that structural inequalities manifest not only in homeownership access but also in the physical conditions of owned properties.</p>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>Future studies combining both sociodemographic and structural variables could offer more complete models and inform policies addressing housing equity.</p>
<p>All in all, future work can combine both types of variables to create richer predictive models and more comprehensive policy insights.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/sussmanbu\.github\.io\/ma4615-sp25-final-project-team-3\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>